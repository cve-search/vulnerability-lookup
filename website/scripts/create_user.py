#!/usr/bin/env python3

from typing import Union
from werkzeug.security import generate_password_hash

from website.web.bootstrap import db
from website.models import User


def create_user(login: str, email: str, password: str, is_active: bool, is_confirmed: bool, is_admin: bool) -> Union[User, Exception]:
    """Creates a normal user or an administrator."""
    user = User(
        login=login,
        email=email,
        pwdhash=generate_password_hash(password),
        is_active=is_active,
        is_confirmed=is_confirmed,
        is_admin=is_admin,
    )
    try:
        db.session.add(user)
        db.session.commit()
        return user
    except Exception as e:
        db.session.rollback()
        raise e
