{% extends "main.html" %}
{% block title %}Set up Two-Factor Authentication{% endblock %}

{% block content %}

<div class="row">
    <div class="col-md-6">
      <main class="form-signin w-100 m-auto">
          <h5>Instructions</h5>
            <ul>
              <li>Install an authenticator application on your mobile.</li>
              <li>Scan the QRCode or copy the secret token.</li>
            </ul>
            <div class="text-center">
              <img src="data:image/png;base64, {{ qr_image }}" alt="Secret Token" style="width:200px;height:200px"/>
            </div>
          <div class="form-group">
            <label for="secret">Secret Token</label>
            <input type="text" class="form-control" id="secret" value="{{ secret }}" readonly>
          </div>
          <div class="text-center mt-2">
            <button class='btn btn-primary' id='copySecret'>Copy Secret</button>
          </div>
          <p class="mt-6 text-center">
            Once you have scanned the QR, please click <a href="{{ url_for('user_bp.verify_two_factor_auth') }}">here</a>.
          </p>
      </main>
    </div>
    <div class="col-md-6"></div>
  </div>
  {% block js %}
<script>
document.addEventListener("DOMContentLoaded", function() {
  document.getElementById("copySecret").onclick = function(event) {
    var copyText = document.getElementById("secret");
    navigator.clipboard.writeText(copyText.value).then(function() {
      /* clipboard successfully set */
      alert("Successfully copied TOTP secret token!");
    }, function() {
      /* clipboard write failed */
    });
  };
});
</script>
{% endblock %}
{% endblock %}
